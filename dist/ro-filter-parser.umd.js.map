{"version":3,"file":"ro-filter-parser.umd.js","sources":["../src/util/category.js","../src/util/object-to-string.js","../src/util/get-object-index.js","../src/util/siv.js","../src/util/clean-object.js","../src/util/extract-siv-included.js","../src/ro-filter-parser.js"],"sourcesContent":["/* eslint-disable no-param-reassign */\nconst categoryTypes = [\n  'includedWithSubcategories',\n  'includedWithoutSubcategories',\n  'excludedWithSubcategories',\n  'excludedWithoutSubcategories',\n];\n\nexport function setCategoryCodes(subtype, values) {\n  const updatedCat = {};\n  if (subtype === 'subcategory-included') {\n    updatedCat.includedWithSubcategories = [...values];\n  }\n  if (subtype === 'subcategory-excluded') {\n    updatedCat.includedWithoutSubcategories = [...values];\n  }\n  return updatedCat;\n}\n\nexport function addCategoryCodes(categoryObject, subtype, values) {\n  // If the value already exists anywhere in categories, remove it\n  categoryTypes.forEach(type => {\n    if (categoryObject[type]) {\n      categoryObject[type] = categoryObject[type].filter(value => !values.includes(value));\n    }\n  });\n  if (subtype === 'subcategory-included') {\n    const currentValues = categoryObject.includedWithSubcategories || [];\n    categoryObject.includedWithSubcategories = Array.from(new Set([...currentValues, ...values]));\n  }\n  if (subtype === 'subcategory-excluded') {\n    const currentValues = categoryObject.includedWithoutSubcategories || [];\n    categoryObject.includedWithoutSubcategories = Array.from(new Set([...currentValues, ...values]));\n  }\n  return categoryObject;\n}\n","// Coz flatMap seems to be implemented only in Node11\nimport { flatten } from 'ramda';\n\nexport default function convertObjectToString(filter) {\n  if (filter.constructor === Array) {\n    return filter.map(f => `${convertObjectToString(f)}`).join('|');\n  }\n  if (filter.constructor === Object) {\n    const filterArray = [];\n    if (filter.SIV_ATTRIBUTE) {\n      const filterStringArray = flatten(\n        Object.keys(filter.SIV_ATTRIBUTE).map(type =>\n          Object.keys(filter.SIV_ATTRIBUTE[type]).map(subtype => {\n            const equalOp = subtype.includes('include') ? '==' : '!=';\n            const values = filter.SIV_ATTRIBUTE[type][subtype].map(value => `${value}`).join(',');\n            return `SIV_ATTRIBUTE(${type})${equalOp}[${values}]`;\n          })\n        )\n      );\n\n      filterArray.push(...filterStringArray);\n    }\n    if (filter.CATEGORY) {\n      const { CATEGORY } = filter;\n      const filterStringArray = Object.keys(CATEGORY).map(key => {\n        const equalOp = key.includes('include') ? '==' : '!=';\n        const subcategoryOp = key.includes('Without') ? 'false' : 'true';\n        const values = CATEGORY[key].map(value => `\"${value}\"`).join(',');\n        return `CATEGORY(${subcategoryOp})${equalOp}[${values}]`;\n      });\n      filterArray.push(filterStringArray);\n    }\n    if (filter.array) {\n      filterArray.push(convertObjectToString(filter.array));\n    }\n    return filterArray.length > 1 ? `(${filterArray.join('&')})` : filterArray.join('&');\n  }\n  return '';\n}\n","export default function getObjectIndex(filterArray) {\n  let result;\n  filterArray.forEach((f, i) => {\n    if (JSON.stringify(f) !== '{}') {\n      result = i;\n    }\n  });\n  return result;\n}\n","import { mergeDeepRight } from 'ramda';\nimport getObjectIndex from './get-object-index';\n\n/* eslint-disable no-param-reassign */\nexport default function setSivValues(parsedFilter, sivIncluded, subtype, values) {\n  let includedIds = sivIncluded ? sivIncluded.SIV_ATTRIBUTE.id.included : [];\n  if (subtype === 'id-included') {\n    includedIds = values;\n    // Rewrite this so that we don't need param reassign\n    parsedFilter.forEach((f, index) => {\n      if (\n        parsedFilter[index].SIV_ATTRIBUTE\n        && parsedFilter[index].SIV_ATTRIBUTE.id\n        && parsedFilter[index].SIV_ATTRIBUTE.id.excluded\n      ) {\n        parsedFilter[index].SIV_ATTRIBUTE.id.excluded = parsedFilter[index].SIV_ATTRIBUTE.id.excluded.filter(\n          id => !values.includes(id),\n        );\n      }\n      // If all the included values are filtered out, delete SIV_ATTRIBUTE key\n      if (\n        parsedFilter[index].SIV_ATTRIBUTE\n        && parsedFilter[index].SIV_ATTRIBUTE.id\n        && parsedFilter[index].SIV_ATTRIBUTE.id.excluded\n        && parsedFilter[index].SIV_ATTRIBUTE.id.excluded.length === 0\n      ) {\n        delete parsedFilter[index].SIV_ATTRIBUTE.id;\n      }\n    });\n  }\n  if (subtype === 'id-excluded') {\n    let updated = false;\n    if (sivIncluded) {\n      includedIds = includedIds.filter(id => !values.includes(id));\n    }\n    parsedFilter.forEach((f, index) => {\n      if (\n        parsedFilter[index].SIV_ATTRIBUTE\n        && parsedFilter[index].SIV_ATTRIBUTE.id\n        && parsedFilter[index].SIV_ATTRIBUTE.id.excluded\n      ) {\n        parsedFilter[index].SIV_ATTRIBUTE.id.excluded = values;\n        updated = true;\n      }\n    });\n    if (!updated) {\n      const index = getObjectIndex(parsedFilter);\n      parsedFilter[index] = mergeDeepRight(parsedFilter[index], { SIV_ATTRIBUTE: { id: { excluded: values } } });\n    }\n  }\n  if (subtype === 'supplier-included') {\n    const index = getObjectIndex(parsedFilter);\n    parsedFilter[index] = mergeDeepRight(parsedFilter[index], { SIV_ATTRIBUTE: { supplier: { included: values } } });\n  }\n  const updatedSivIncluded = includedIds.length ? { SIV_ATTRIBUTE: { id: { included: includedIds } } } : null;\n  return { parsedFilter, updatedSivIncluded };\n}\n","/**\n * This is used to remove any empty objects going through it recursively\n *\n * @export\n * @param {Object} obj\n * @returns {Object}\n *\n * @example\n  const test = {\n    SIV: {\n      id: {},\n      incl: [1]\n    },\n    SIV2: {\n      id: {\n        included: {}\n      }\n    }\n  }\n\n  cleanObject(test)\n  Output: { SIV: { incl: [ 1 ] } }\n */\nexport default function cleanObject(obj) {\n  const resultObject = {};\n  Object.keys(obj).forEach(key => {\n    if (obj[key].constructor === Object) {\n      resultObject[key] = cleanObject(obj[key]);\n      if (JSON.stringify(resultObject[key]) === '{}') {\n        delete resultObject[key];\n      }\n    } else {\n      resultObject[key] = obj[key];\n    }\n  });\n  return resultObject;\n}\n","export default function extractSivIncluded(parsedFilter, sivIncluded) {\n  let updatedSivIncluded = sivIncluded;\n  const updatedFilter = parsedFilter.map(filter => {\n    if (filter.SIV_ATTRIBUTE && filter.SIV_ATTRIBUTE.id.included) {\n      if (updatedSivIncluded) {\n        updatedSivIncluded.SIV_ATTRIBUTE.id.included.push(...filter.SIV_ATTRIBUTE.id.included);\n      } else {\n        updatedSivIncluded = {\n          SIV_ATTRIBUTE: {\n            id: {\n              included: filter.SIV_ATTRIBUTE.id.included,\n            },\n          },\n        };\n      }\n      delete filter.SIV_ATTRIBUTE.id.included;\n    }\n    if (filter.array) {\n      ({ updatedFilter: filter.array, updatedSivIncluded } = extractSivIncluded(filter.array, updatedSivIncluded));\n      // This is being done only because of the way the current filter definitions are set up where they are wrongly grouped based on the OR.\n      // Basically all the current definitions have been slightly wrong but because they were never grouped with anything else, it was not noticable.\n      filter.array.forEach(f => {\n        if (f.CATEGORY) {\n          filter.CATEGORY = f.CATEGORY;\n        }\n        delete f.CATEGORY;\n      });\n    }\n    return filter;\n  });\n  return { updatedFilter, updatedSivIncluded };\n}\n","import { setCategoryCodes, addCategoryCodes } from './util/category';\nimport convertObjectToString from './util/object-to-string';\nimport setSivValues from './util/siv';\nimport cleanObject from './util/clean-object';\nimport extractSivIncluded from './util/extract-siv-included';\n\nconst nearley = require('nearley');\nconst grammar = require('../src/compiled-grammar/main');\n\n/**\n * The main function of the library. Parses the filter string to return a JSON object\n *\n * @export\n * @param {string} filterString - the filter string\n * @returns {object} - a json representation of the string\n */\nexport function parseFilterString(filterString) {\n  // Create a Parser object from our grammar.\n  const parser = new nearley.Parser(nearley.Grammar.fromCompiled(grammar));\n  parser.feed(filterString);\n\n  const { results } = parser;\n  if (results.length > 1) return 'Ambigous grammar. Bad!';\n  if (results.length === 0) return 'Empty result. Weird!';\n\n  return results[0];\n}\n\nexport function addToFilter(definition, { label, subtype, values }) {\n  const parsedFilter = parseFilterString(definition);\n  switch (label) {\n    case 'CATEGORY':\n      parsedFilter.forEach((filter, index) => {\n        if (parsedFilter[index].CATEGORY) {\n          parsedFilter[index].CATEGORY = addCategoryCodes(filter.CATEGORY, subtype, values);\n        }\n      });\n      break;\n\n    default:\n      break;\n  }\n  return convertObjectToString(parsedFilter);\n}\n\nexport function setFilter(definition, { label, subtype, values }) {\n  let parsedFilter = parseFilterString(definition);\n\n  // SIV ATTRIBUTE Included is a special case where if the value is included that is \"ORed\" to all the other rules.\n  // So we extract it out\n  let sivIncluded;\n  ({ updatedSivIncluded: sivIncluded, updatedFilter: parsedFilter } = extractSivIncluded(parsedFilter, sivIncluded));\n\n  parsedFilter.forEach((filter, index) => {\n    if (parsedFilter[index].array) {\n      const cleanArray = parsedFilter[index].array.map(f => cleanObject(f)).filter(f => JSON.stringify(f) !== '{}');\n      if (cleanArray.length) {\n        parsedFilter[index].array = cleanArray;\n      } else {\n        delete parsedFilter[index].array;\n      }\n    }\n  });\n\n  switch (label) {\n    case 'CATEGORY': {\n      let updated = false;\n      parsedFilter.forEach((filter, index) => {\n        if (parsedFilter[index].CATEGORY) {\n          parsedFilter[index].CATEGORY = setCategoryCodes(subtype, values);\n          updated = true;\n        }\n      });\n      if (!updated) {\n        const CATEGORY = setCategoryCodes(subtype, values);\n        parsedFilter[0].CATEGORY = CATEGORY;\n      }\n      break;\n    }\n    case 'SIV': {\n      ({ updatedSivIncluded: sivIncluded, parsedFilter } = setSivValues(parsedFilter, sivIncluded, subtype, values));\n      break;\n    }\n\n    default:\n      break;\n  }\n\n  // Remove any empty objects (maybe caused by the SIV extraction)\n  parsedFilter.forEach((filter, index) => {\n    parsedFilter[index] = cleanObject(parsedFilter[index]);\n  });\n  parsedFilter = parsedFilter.filter(filter => JSON.stringify(filter) !== '{}');\n  if (sivIncluded && parsedFilter.length) {\n    parsedFilter.push(sivIncluded);\n  }\n  const convertedFilter = parsedFilter.length ? parsedFilter : sivIncluded;\n  return convertObjectToString(convertedFilter);\n}\n"],"names":["flatten","mergeDeepRight"],"mappings":"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"}