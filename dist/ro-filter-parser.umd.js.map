{"version":3,"file":"ro-filter-parser.umd.js","sources":["../src/util/category.js","../src/util/object-to-string.js","../src/util/siv.js","../src/util/clean-object.js","../src/ro-filter-parser.js"],"sourcesContent":["/* eslint-disable no-param-reassign */\nconst categoryTypes = [\n  'includedWithSubcategories',\n  'includedWithoutSubcategories',\n  'excludedWithSubcategories',\n  'excludedWithoutSubcategories',\n];\n\nexport function setCategoryCodes(subtype, values) {\n  const updatedCat = {};\n  if (subtype === 'subcategory-included') {\n    updatedCat.includedWithSubcategories = [...values];\n  }\n  if (subtype === 'subcategory-excluded') {\n    updatedCat.includedWithoutSubcategories = [...values];\n  }\n  return updatedCat;\n}\n\nexport function addCategoryCodes(categoryObject, subtype, values) {\n  // If the value already exists anywhere in categories, remove it\n  categoryTypes.forEach(type => {\n    if (categoryObject[type]) {\n      categoryObject[type] = categoryObject[type].filter(value => !values.includes(value));\n    }\n  });\n  if (subtype === 'subcategory-included') {\n    const currentValues = categoryObject.includedWithSubcategories || [];\n    categoryObject.includedWithSubcategories = Array.from(new Set([...currentValues, ...values]));\n  }\n  if (subtype === 'subcategory-excluded') {\n    const currentValues = categoryObject.includedWithoutSubcategories || [];\n    categoryObject.includedWithoutSubcategories = Array.from(new Set([...currentValues, ...values]));\n  }\n  return categoryObject;\n}\n","// Coz flatMap seems to be implemented only in Node11\nconst concat = (x, y) => x.concat(y);\n\nexport default function convertObjectToString(filter) {\n  if (filter.constructor === Array) {\n    return filter.reduce((str, f) => {\n      if (str === '') {\n        return `(${convertObjectToString(f)})`;\n      }\n      return `(${str.substring(1, str.length - 1)}|${convertObjectToString(f)})`;\n    }, '');\n  }\n  if (filter.constructor === Object) {\n    const filterArray = [];\n    if (filter.SIV_ATTRIBUTE) {\n      const filterString = Object.keys(filter.SIV_ATTRIBUTE)\n        .map(type => Object.keys(filter.SIV_ATTRIBUTE[type]).map(subtype => {\n          const equalOp = subtype.includes('include') ? '==' : '!=';\n          const values = filter.SIV_ATTRIBUTE[type][subtype].map(value => `${value}`).join(',');\n          return `SIV_ATTRIBUTE(${type})${equalOp}[${values}]`;\n        }))\n        .reduce(concat, [])\n        .join('&');\n\n      filterArray.push(filterString);\n    }\n    if (filter.CATEGORY) {\n      const { CATEGORY } = filter;\n      const filterString = Object.keys(CATEGORY)\n        .map(key => {\n          const equalOp = key.includes('include') ? '==' : '!=';\n          const subcategoryOp = key.includes('Without') ? 'false' : 'true';\n          const values = CATEGORY[key].map(value => `\"${value}\"`).join(',');\n          return `CATEGORY(${subcategoryOp})${equalOp}[${values}]`;\n        })\n        .join('&');\n      filterArray.push(filterString);\n    }\n    if (filter.array) {\n      filterArray.push(convertObjectToString(filter.array));\n    }\n    return filterArray.join('&');\n  }\n  return '';\n}\n","/* eslint-disable no-param-reassign */\nexport default function setSivValues(parsedFilter, sivExcludedFilter, subtype, values) {\n  let excludedIds = sivExcludedFilter ? sivExcludedFilter.SIV_ATTRIBUTE.id.excluded : [];\n  if (subtype === 'id-excluded') {\n    excludedIds = values;\n    // Rewrite this so that we don't need param reassign\n    parsedFilter.forEach((f, index) => {\n      if (\n        parsedFilter[index].SIV_ATTRIBUTE\n        && parsedFilter[index].SIV_ATTRIBUTE.id\n        && parsedFilter[index].SIV_ATTRIBUTE.id.included\n      ) {\n        parsedFilter[index].SIV_ATTRIBUTE.id.included = parsedFilter[index].SIV_ATTRIBUTE.id.included.filter(\n          id => !values.includes(id),\n        );\n      }\n      // If all the included values are filtered out, delete SIV_ATTRIBUTE key\n      if (\n        parsedFilter[index].SIV_ATTRIBUTE\n        && parsedFilter[index].SIV_ATTRIBUTE.id\n        && parsedFilter[index].SIV_ATTRIBUTE.id.included\n        && parsedFilter[index].SIV_ATTRIBUTE.id.included.length === 0\n      ) {\n        delete parsedFilter[index].SIV_ATTRIBUTE.id;\n      }\n    });\n  }\n  if (subtype === 'id-included') {\n    let updated = false;\n    if (sivExcludedFilter) {\n      excludedIds = excludedIds.filter(id => !values.includes(id));\n    }\n    parsedFilter.forEach((f, index) => {\n      if (\n        parsedFilter[index].SIV_ATTRIBUTE\n        && parsedFilter[index].SIV_ATTRIBUTE.id\n        && parsedFilter[index].SIV_ATTRIBUTE.id.included\n      ) {\n        parsedFilter[index].SIV_ATTRIBUTE.id.included = values;\n        updated = true;\n      }\n    });\n    if (!updated) {\n      parsedFilter.push({ SIV_ATTRIBUTE: { id: { included: values } } });\n    }\n  }\n  if (subtype === 'supplier-included') {\n    parsedFilter.push({ SIV_ATTRIBUTE: { supplier: { included: values } } });\n  }\n  const updatedSivExcludedFilter = excludedIds.length ? { SIV_ATTRIBUTE: { id: { excluded: excludedIds } } } : null;\n  return { parsedFilter, updatedSivExcludedFilter };\n}\n","/**\n * This is used to remove any empty objects going through it recursively\n *\n * @export\n * @param {Object} obj\n * @returns {Object}\n *\n * @example\n  const test = {\n    SIV: {\n      id: {},\n      incl: [1]\n    },\n    SIV2: {\n      id: {\n        included: {}\n      }\n    }\n  }\n\n  cleanObject(test)\n  Output: { SIV: { incl: [ 1 ] } }\n */\nexport default function cleanObject(obj) {\n  const resultObject = {};\n  Object.keys(obj).forEach(key => {\n    if (obj[key].constructor === Object) {\n      resultObject[key] = cleanObject(obj[key]);\n      if (JSON.stringify(resultObject[key]) === '{}') {\n        delete resultObject[key];\n      }\n    } else {\n      resultObject[key] = obj[key];\n    }\n  });\n  return resultObject;\n}\n","import { setCategoryCodes, addCategoryCodes } from './util/category';\nimport convertObjectToString from './util/object-to-string';\nimport setSivValues from './util/siv';\nimport cleanObject from './util/clean-object';\n\nconst nearley = require('nearley');\nconst grammar = require('../src/compiled-grammar/main');\n\n/**\n * The main function of the library. Parses the filter string to return a JSON object\n *\n * @export\n * @param {string} filterString - the filter string\n * @returns {object} - a json representation of the string\n */\nexport function parseFilterString(filterString) {\n  // Create a Parser object from our grammar.\n  const parser = new nearley.Parser(nearley.Grammar.fromCompiled(grammar));\n  parser.feed(filterString);\n\n  const { results } = parser;\n  if (results.length > 1) return 'Ambigous grammar. Bad!';\n  if (results.length === 0) return 'Empty result. Weird!';\n\n  return results[0];\n}\n\nexport function addToFilter(definition, { label, subtype, values }) {\n  const parsedFilter = parseFilterString(definition);\n  switch (label) {\n    case 'CATEGORY':\n      parsedFilter.forEach((filter, index) => {\n        if (parsedFilter[index].CATEGORY) {\n          parsedFilter[index].CATEGORY = addCategoryCodes(filter.CATEGORY, subtype, values);\n        }\n      });\n      break;\n\n    default:\n      break;\n  }\n  return convertObjectToString(parsedFilter);\n}\n\nexport function setFilter(definition, { label, subtype, values }) {\n  let parsedFilter = parseFilterString(definition);\n\n  // SIV ATTRIBUTE Excluded is a special case where if the value is excluded that is \"ANDed\" to all the other rules.\n  // So we extract it out\n  let sivExcludedFilter;\n  parsedFilter.forEach((filter, index) => {\n    // This whole if condition is to achieve the SIV excluded extraction mentioned above\n    if (parsedFilter[index].SIV_ATTRIBUTE && parsedFilter[index].SIV_ATTRIBUTE.id.excluded) {\n      if (sivExcludedFilter) {\n        sivExcludedFilter.SIV_ATTRIBUTE.id.excluded.push(...parsedFilter[index].SIV_ATTRIBUTE.id.excluded);\n      } else {\n        sivExcludedFilter = {\n          SIV_ATTRIBUTE: {\n            id: {\n              excluded: parsedFilter[index].SIV_ATTRIBUTE.id.excluded,\n            },\n          },\n        };\n      }\n      delete parsedFilter[index].SIV_ATTRIBUTE.id.excluded;\n    }\n  });\n\n  // Assuming filters are currently going to have only a single & at the top level for now\n  if (parsedFilter.length === 1 && parsedFilter[0].array) {\n    parsedFilter = parsedFilter[0].array;\n  }\n\n  switch (label) {\n    case 'CATEGORY': {\n      let updated = false;\n      parsedFilter.forEach((filter, index) => {\n        if (parsedFilter[index].CATEGORY) {\n          parsedFilter[index].CATEGORY = setCategoryCodes(subtype, values);\n          updated = true;\n        }\n      });\n      if (!updated) {\n        const CATEGORY = setCategoryCodes(subtype, values);\n        parsedFilter.push({ CATEGORY });\n      }\n      break;\n    }\n    case 'SIV': {\n      ({ updatedSivExcludedFilter: sivExcludedFilter, parsedFilter } = setSivValues(\n        parsedFilter,\n        sivExcludedFilter,\n        subtype,\n        values,\n      ));\n      break;\n    }\n\n    default:\n      break;\n  }\n\n  // Remove any empty objects (maybe caused by the SIV extraction)\n  parsedFilter.forEach((filter, index) => {\n    parsedFilter[index] = cleanObject(parsedFilter[index]);\n  });\n  parsedFilter = parsedFilter.filter(filter => JSON.stringify(filter) !== '{}');\n  if (sivExcludedFilter && parsedFilter.length) {\n    sivExcludedFilter.array = parsedFilter;\n  }\n  const convertedFilter = sivExcludedFilter || parsedFilter;\n  return convertObjectToString(convertedFilter);\n}\n"],"names":[],"mappings":"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"}